(function(b){var a={VERSION:"0.5.2"};a.System=function(){this._mappings={};this._outlets={};this._handlers={};this.strictInjections=true;this.autoMapOutlets=false;this.postInjectionHook="setup"};a.System.prototype={_createAndSetupInstance:function(d,e){var c=new e();this.injectInto(c,d);return c},_retrieveFromCacheOrCreate:function(f,e){if(typeof e==="undefined"){e=false}var c;if(this._mappings.hasOwnProperty(f)){var d=this._mappings[f];if(!e&&d.isSingleton){if(d.object==null){d.object=this._createAndSetupInstance(f,d.clazz)}c=d.object}else{if(d.clazz){c=this._createAndSetupInstance(f,d.clazz)}else{c=d.object}}}else{throw new Error(1000)}return c},mapOutlet:function(e,d,c){if(typeof e==="undefined"){throw new Error(1010)}d=d||"global";c=c||e;if(!this._outlets.hasOwnProperty(d)){this._outlets[d]={}}this._outlets[d][c]=e;return this},getObject:function(c){if(typeof c==="undefined"){throw new Error(1020)}return this._retrieveFromCacheOrCreate(c)},mapValue:function(c,d){if(typeof c==="undefined"){throw new Error(1030)}this._mappings[c]={clazz:null,object:d,isSingleton:true};if(this.autoMapOutlets){this.mapOutlet(c)}if(this.hasMapping(c)){this.injectInto(d,c)}return this},hasMapping:function(c){if(typeof c==="undefined"){throw new Error(1040)}return this._mappings.hasOwnProperty(c)},mapClass:function(d,c){if(typeof d==="undefined"){throw new Error(1050)}if(typeof c==="undefined"){throw new Error(1051)}this._mappings[d]={clazz:c,object:null,isSingleton:false};if(this.autoMapOutlets){this.mapOutlet(d)}return this},mapSingleton:function(d,c){if(typeof d==="undefined"){throw new Error(1060)}if(typeof c==="undefined"){throw new Error(1061)}this._mappings[d]={clazz:c,object:null,isSingleton:true};if(this.autoMapOutlets){this.mapOutlet(d)}return this},instantiate:function(c){if(typeof c==="undefined"){throw new Error(1070)}return this._retrieveFromCacheOrCreate(c,true)},injectInto:function(c,f){if(typeof c==="undefined"){throw new Error(1080)}var j=[];if(this._outlets.hasOwnProperty("global")){j.push(this._outlets.global)}if(typeof f!=="undefined"&&this._outlets.hasOwnProperty(f)){j.push(this._outlets[f])}for(var e in j){var d=j[e];for(var h in d){var g=d[h];if(!this.strictInjections||h in c){c[h]=this.getObject(g)}}}if(typeof c[this.postInjectionHook]==="function"){c[this.postInjectionHook].call(c)}return this},unmap:function(c){if(typeof c==="undefined"){throw new Error(1090)}delete this._mappings[c];return this},unmapOutlet:function(d,c){if(typeof d==="undefined"){throw new Error(1100)}if(typeof c==="undefined"){throw new Error(1101)}delete this._outlets[d][c];return this},mapHandler:function(d,e,f,g,c){if(typeof d==="undefined"){throw new Error(1110)}e=e||"global";f=f||d;if(typeof g==="undefined"){g=false}if(typeof c==="undefined"){c=false}if(!this._handlers.hasOwnProperty(d)){this._handlers[d]={}}if(!this._handlers[d].hasOwnProperty(e)){this._handlers[d][e]=[]}this._handlers[d][e].push({handler:f,oneShot:g,passEvent:c});return this},unmapHandler:function(d,g,h){if(typeof d==="undefined"){throw new Error(1120)}g=g||"global";h=h||d;if(this._handlers.hasOwnProperty(d)&&this._handlers[d].hasOwnProperty(g)){var c=this._handlers[d][g];for(var f in c){var e=c[f];if(e.handler===h){c.splice(f,1);break}}}return this},notify:function(j){if(typeof j==="undefined"){throw new Error(1130)}var l=Array.prototype.slice.call(arguments);var e=l.slice(1);if(this._handlers.hasOwnProperty(j)){var f=this._handlers[j];for(var m in f){var k=f[m];var o;if(m!=="global"){o=this.getObject(m)}var h=[];var g,d;for(g=0,d=k.length;g<d;g++){var p;var c=k[g];if(o&&typeof c.handler==="string"){p=o[c.handler]}else{p=c.handler}if(c.oneShot){h.unshift(g)}if(c.passEvent){p.apply(o,l)}else{p.apply(o,e)}}for(g=0,d=h.length;g<d;g++){k.splice(h[g],1)}}}return this}};b.dijon=a}(this));